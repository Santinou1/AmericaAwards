# API de Sistema de Gamificación Laboral

### Verificar API
GET http://localhost:3000/

## Creación Inicial

### Crear Primer Usuario Administrador (Solo funciona una vez)
POST http://localhost:3000/api/usuarios/primer-admin
Content-Type: application/json

{
    "nombre": "Admin Principal",
    "email": "admin@empresa.com",
    "password": "admin123456"
}

## Autenticación

### Login Usuario
POST http://localhost:3000/api/auth
Content-Type: application/json

{
    "email": "admin@empresa.com",
    "password": "admin123456"
}

### Obtener Usuario Autenticado
GET http://localhost:3000/api/auth
x-auth-token: {{authToken}}

## Usuarios (Requieren autenticación)

### Obtener Todos los Usuarios (Solo Admin)
GET http://localhost:3000/api/usuarios
x-auth-token: {{authToken}}

### Obtener Usuario por ID (Admin o mismo usuario)
GET http://localhost:3000/api/usuarios/{{userId}}
x-auth-token: {{authToken}}

### Crear Usuario (Solo Admin)
POST http://localhost:3000/api/usuarios
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "nombre": "Juan Pérez",
    "email": "juan@empresa.com",
    "password": "123456abc",
    "rol": "empleado"
}

### Actualizar Usuario (Admin o mismo usuario)
PUT http://localhost:3000/api/usuarios/679cd5f4b5d326bfa7e2f4cb
Content-Type: application/json
x-auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c3VhcmlvIjp7ImlkIjoiNjc5Y2Q1ZDJiNWQzMjZiZmE3ZTJmNGM4Iiwibm9tYnJlIjoiQWRtaW4gUHJpbmNpcGFsIiwiZW1haWwiOiJhZG1pbkBlbXByZXNhLmNvbSIsInJvbCI6ImFkbWluaXN0cmFkb3IifSwiaWF0IjoxNzM4MzMxNjAyLCJleHAiOjE3MzgzNjA0MDJ9.3Yc973SOryyrrNEa8atDKSIMbx_LPgGxdFXfeAE0484

{
    "saldo_puntos_canjeables": 10000

}

### Eliminar Usuario (Solo Admin)
DELETE http://localhost:3000/api/usuarios/{{userId}}
x-auth-token: {{authToken}}

## Transferencias (Requieren autenticación)

### Realizar Transferencia
POST http://localhost:3000/api/transferencias
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "receptor_id": "{{receptorId}}",
    "puntos": 50,
    "mensaje": "¡Gracias por tu ayuda en el proyecto!"
}

### Obtener Mis Transferencias
GET http://localhost:3000/api/transferencias/mis-transferencias
x-auth-token: {{authToken}}

### Obtener Todas las Transferencias (Solo Admin)
GET http://localhost:3000/api/transferencias
x-auth-token: {{authToken}}

## Premios (Requieren autenticación)

### Obtener Todos los Premios
GET http://localhost:3000/api/premios
x-auth-token: {{authToken}}

### Obtener Premio por ID
GET http://localhost:3000/api/premios/{{premioId}}
x-auth-token: {{authToken}}

### Crear Premio (Solo Admin)
POST http://localhost:3000/api/premios
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "nombre": "Día Libre",
    "descripcion": "Un día libre para usar cuando quieras",
    "costo_puntos": 1000,
    "stock": 5
}

### Actualizar Premio (Solo Admin)
PUT http://localhost:3000/api/premios/{{premioId}}
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "nombre": "Día Libre Premium",
    "descripcion": "Un día libre con bono adicional",
    "costo_puntos": 1200,
    "stock": 3
}

### Eliminar Premio (Solo Admin)
DELETE http://localhost:3000/api/premios/{{premioId}}
x-auth-token: {{authToken}}

## Canjes (Requieren autenticación)

### Realizar Canje de Premio
POST http://localhost:3000/api/canjes
Content-Type: application/json
x-auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c3VhcmlvIjp7ImlkIjoiNjc5Y2Q1ZjRiNWQzMjZiZmE3ZTJmNGNiIiwibm9tYnJlIjoiSnVhbiBQw6lyZXoiLCJlbWFpbCI6Imp1YW5AZW1wcmVzYS5jb20iLCJyb2wiOiJlbXBsZWFkbyJ9LCJpYXQiOjE3MzgzMzE4NzIsImV4cCI6MTczODM2MDY3Mn0.3boSmST_CAcLCkTwemISnQdlfPwJjViRtY7hcTSCeek

{
    "premio_id": "679cda512d662f8757ac2fee",
    "cantidad": 1
}

### Obtener Mis Canjes
GET http://localhost:3000/api/canjes/mis-canjes
x-auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c3VhcmlvIjp7ImlkIjoiNjc5Y2Q1ZjRiNWQzMjZiZmE3ZTJmNGNiIiwibm9tYnJlIjoiSnVhbiBQw6lyZXoiLCJlbWFpbCI6Imp1YW5AZW1wcmVzYS5jb20iLCJyb2wiOiJlbXBsZWFkbyJ9LCJpYXQiOjE3MzgzMzE4NzIsImV4cCI6MTczODM2MDY3Mn0.3boSmST_CAcLCkTwemISnQdlfPwJjViRtY7hcTSCeek

### Obtener Todos los Canjes (Solo Admin)
GET http://localhost:3000/api/canjes
x-auth-token: {{authToken}}

### Ejemplos de Errores

### Intento de Transferencia sin Saldo Suficiente
POST http://localhost:3000/api/transferencias
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "receptor_id": "{{receptorId}}",
    "puntos": 1000000,
    "mensaje": "Intento de transferencia con saldo insuficiente"
}

### Intento de Transferencia a Sí Mismo
POST http://localhost:3000/api/transferencias
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "receptor_id": "{{userId}}",
    "puntos": 50,
    "mensaje": "Intento de auto-transferencia"
}

### Intento de Crear Premio sin ser Admin
POST http://localhost:3000/api/premios
Content-Type: application/json
x-auth-token: {{tokenUsuarioNoAdmin}}

{
    "nombre": "Premio No Autorizado",
    "descripcion": "Intento de crear premio sin ser admin",
    "costo_puntos": 100,
    "stock": 1
}

### Intento de Canje sin Saldo Suficiente
POST http://localhost:3000/api/canjes
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "premio_id": "{{premioId}}",
    "cantidad": 1,
    "mensaje": "Intento de canje con saldo insuficiente"
}

### Intento de Canje con Stock Insuficiente
POST http://localhost:3000/api/canjes
Content-Type: application/json
x-auth-token: {{authToken}}

{
    "premio_id": "{{premioId}}",
    "cantidad": 1000,
    "mensaje": "Intento de canje con stock insuficiente"
}